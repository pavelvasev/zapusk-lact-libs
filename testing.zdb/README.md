# testing

Идея testing в том, что можно для любой запуск-программы запросить действие testing
и получить набор тестов для проверки результата этой программы.

Под результатом программы понимается ее стандартное действие. То есть программа по замыслу
должна что-то сделать с машиной, и testing как раз и перечисляет, что следует проверять,
чтобы убедиться что то что от программы ожидалось - выполняется.

Под тестами понимается перечень тестов. Этот перечень следует передать какой-нибудь
тестирующей программе.

## Устройство теста

Каждый тест это запись с полями:
* **code** - код теста
* **comment** - текстовый комментарий
* **набор параметров теста** - свободный набор, соответствующий коду теста.

## Формат записи теста

Для указания теста предлагается задавать шаг `[testing]`, в формате аналогичном другим zapusk-инструкциям.
Параметры теста следует перечислять как `arg_имяпараметра`, например `arg_path`, `arg_mode` и т.п.

## Пример
```
########### program1
[os]
apply=echo 1>/etc/myfile.conf

########### program1-testing
[testing]
code=file-exist
comment=Проверить присутствие файла
arg_path=/etc/myfile.conf
```

Результат: 
* zapusk apply -- стандартное действие, в данном случае запись 1 в файл /etc/myfile.conf
* zapusk testing -- напечатает запись об 1 обнаруженном тесте: следует проверять наличие файла /etc/myfile.conf.

## Получение перечня тестов

Следует выполнить zapusk с командой testing:
* `zapusk testing`

В результате запуск напечатает список тестов на экран.

Чтобы zapusk вместо печати сохранил тесты в файл, следует указать формат и номер файлового дескриптора для записи.
В настоящее время поддерживается 2 формата: lisp и yaml.

Пример:
```
# запишет в формате list
TESTING_LISP=3 zapusk testing 3>all-tests.txt
# запишет в формате yaml
TESTING_YAML=4 zapusk testing 4>all-tests.yaml
```

## Коды тестов

См. (testsmd)[tests.md]
