# x-backup

Предназначение: инкрементальный rsync с раскладкой по папкам с датами.

# Параметры

* **src** - источник для rsync. Можно указать rsync-endpoint, ssh-rsync, или каталог на локальной файловой системе.
* **tgtdir** - каталог для результатов. 

# Команды

* **apply** - выполнить rsync.

# Пример

```
########### mybackup
[xbackup]
src=ssh://user@host:/some/dir 
tgtdir=/archive/dir
```
Результат: при вызове apply в каталоге /archive/dir будет создан каталог именем дата-временя и текущим содержимым src.
При последующих вызовах будут создаваться новые подкаталоги с датой-временем.
При этом rsync будет проводится с постановкой жестких ссылок на последние закачанные файлы, если они не менялись.
Таким образом в каждом каталоге дата-время размещается содержимое на это время.

# Особое поведение

x-backup может принимать аргумент-шаг. Тогда он дополнительно вызовет его, и при этом добавит ему параметр tgtdir.
Это удобно для работы в связке с xclean. Например:
```
########### mybackup
[xbackup]
src=ssh://user@host:/some/dir 
tgtdir=/archive/dir
[xclean]
conf=30:7
```
Результат: через 30 дней все архивные копии будут стираться так, чтобы оставалась 1 копия за 7 дней.

# См. также:

* [xif](../xif.zdb) - условие запуска
* [xclean](../xclean.zdb) - очистка старых копий
* [big-example](big-example.zdb) - пример настройки нескольких направлений бэкапа
