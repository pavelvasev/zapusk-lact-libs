# предназначение - создание пользователя на хосте и в чруте с одинаковым id
# todo доработать, потому что параметр prehost_state_dir выглядит глупо
# типа prehost_state_dir={{prehost_state_dir}}/chroota-user

################################# params
# user
# prehost_state_dir

############################ host-user #######################
[commands]
prehost

[info]
apply=Create user on host machine: {{user}}

[]
type=create-user
user={{user}}

############################ save-user-uid #######################
[commands]
prehost

[os]
apply=id -u {{user}} > das_user_id

############################ create-chroota-user #######################
[commands]
system-update
update

# todo - once..

[info]
apply=Create user inside chroota: {{user}}

[]
type=create-user
user={{user}}
user_uid=`cat {{ prehost_state_dir }}/das_user_id || echo "Invalid user id!"`

